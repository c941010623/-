package main

import (
	"fmt"
	"reflect"
	"testing"
)

func TestJsonToMessagePack(t *testing.T) {
	// 測試數據
	jsonStr := `{"name":"Alice","age":20,"score":[80,85,90]}`
	expectedMsgPack := []byte{0x83, 0xa3, 0x61, 0x67, 0x65, 0xcb, 0x40, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa5, 0x73, 0x63, 0x6f, 0x72, 0x65, 0x93, 0xcb, 0x40, 0x54, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xcb, 0x40, 0x55, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0xcb, 0x40, 0x56, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa4, 0x6e, 0x61, 0x6d, 0x65, 0xa5, 0x41, 0x6c, 0x69, 0x63, 0x65}

	// 執行測試
	jsonBytes := []byte(jsonStr)
	actualMsgPack, err := jsonToMessagePack(jsonBytes)
	fmt.Printf("MessagePack: %x\n", actualMsgPack)
	if err != nil {
		t.Errorf("轉換失敗: %v", err)
	}

	// 驗證結果
	if !reflect.DeepEqual(actualMsgPack, expectedMsgPack) {
		t.Errorf("轉換結果不正確，期望: %x，實際: %x", expectedMsgPack, actualMsgPack)
	}
}
